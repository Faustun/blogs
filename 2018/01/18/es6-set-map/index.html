<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="ES6学习笔记：Set和Map数据结构"/>




  <meta name="keywords" content="ES6, Song" />










  <link rel="alternate" href="/blogs/atom.xml" title="Song">




  <link rel="shortcut icon" type="image/x-icon" href="/blogs/favicon.ico?v=2.6.0" />



<link rel="canonical" href="https://songzhiguo.github.io/blogs/2018/01/18/es6-set-map/"/>


<link rel="stylesheet" type="text/css" href="/blogs/css/style.css?v=2.6.0" />



  <link rel="stylesheet" type="text/css" href="/blogs/lib/fancybox/jquery.fancybox.css" />




  



  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









    <title> ES6学习笔记：Set和Map数据结构 - Song </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/blogs/." class="logo">Song</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/blogs/">
        <li class="mobile-menu-item">
          
          
            首页
          
        </li>
      </a>
    
      <a href="/blogs/archives/">
        <li class="mobile-menu-item">
          
          
            归档
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/blogs/." class="logo">
    <img class="header-logo" src="https://songzhiguo.github.io/images/favicon.png">
  </a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/blogs/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/blogs/archives/">
            
            
              归档
            
          </a>
        </li>
      
      <li class="menu-item"><a class="menu-item-link" href="javascript:;">搜索</a></li>
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          ES6学习笔记：Set和Map数据结构
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-01-18
        </span>
        
          <div class="post-category">
            
              <a href="/blogs/categories/ES6/">ES6</a>
            
          </div>
        
        
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Set"><span class="toc-text">Set</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#基本用法"><span class="toc-text">基本用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Set实例的属性和方法"><span class="toc-text">Set实例的属性和方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WeakSet"><span class="toc-text">WeakSet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#语法"><span class="toc-text">语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Map"><span class="toc-text">Map</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#含义和基本用法"><span class="toc-text">含义和基本用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#实例的属性和操作方法"><span class="toc-text">实例的属性和操作方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#遍历方法"><span class="toc-text">遍历方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#与其他数据结构转换"><span class="toc-text">与其他数据结构转换</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WeakMap"><span class="toc-text">WeakMap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#含义"><span class="toc-text">含义</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#WeakMap与Map的区别有两点。"><span class="toc-text">WeakMap与Map的区别有两点。</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WeakMap-的语法"><span class="toc-text">WeakMap 的语法</span></a></li></ol></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><h4 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h4><p>ES6提供的新的数据结构Set。他类似于数组，但是成员值都是唯一值，没有重复值</p>
<p>Set本身是一个构造函数，用来生成Set数据结构</p>
<p>Set函数可以接受一个数组（或者具有iterable接口的其他数据结构）作为参数，用来初始化。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 去除数组的重复成员</span></div><div class="line">[...new <span class="built_in">Set</span>(array)]</div></pre></td></tr></table></figure>
<p>向set加入值的时候，不会发生类型转换，set内部判断两个值是否不同，适用算法叫做“Same-value-equality”,他类似精确相等运算符(===)，主要区别是NaN等于自身，而精确相等运算符认为NaN不等于自身<br><a id="more"></a></p>
<h4 id="Set实例的属性和方法"><a href="#Set实例的属性和方法" class="headerlink" title="Set实例的属性和方法"></a>Set实例的属性和方法</h4><p>Set.prototype.constructor：构造函数，默认就是Set函数</p>
<p>Set.prototype.size：返回Set实例的成员总数。</p>
<p>Set实例方法分为两大类：</p>
<p>一、操作方法（用于操作数据）</p>
<p>add(values)：添加某个值，返回set结构本身</p>
<p>delete(values)：删除某个值，返回一个布尔值，表示删除是否成功</p>
<p>has(values)：返回一个布尔值，表示该值是否为Set成员。</p>
<p>clear()：清楚所有成员，没有返回值。</p>
<p>Array.from方法可以将Set结构转为数组。</p>
<p>二、遍历操作</p>
<p>Set结构的实例四个遍历方法</p>
<p>keys()：返回键名的遍历器</p>
<p>values()：返回键值的遍历器</p>
<p>entries()：返回键值对的遍历器</p>
<p>forEach()：使用回调函数遍历每个成员</p>
<p>由于 Set 结构没有键名，只有键值（或者说键名和键值是同一个值），所以keys方法和values方法的行为完全一致。</p>
<p>Set结构的实例与数组一样，也拥有forEach方法，用于对每个成员执行某种操作，没有返回值。</p>
<p>Set结构的实例方法forEach参数与数组forEach一致，依次为键名、键值、集合本身。另外，forEach方法还可以有第二个参数，表示绑定处理函数的this对象</p>
<h3 id="WeakSet"><a href="#WeakSet" class="headerlink" title="WeakSet"></a>WeakSet</h3><p>WeakSet结构与Set结构类似，也是不重复的值的集合。</p>
<p>WeakSet结构与Set结构有两个区别，首先WeakSet成员只能是对象，而不能是其他类型的值</p>
<h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><p>WeakSet是一个构造函数，可以使用new命令，创建WeakSet数据结构</p>
<p>作为构造函数，WeakSet可以接受一个数组或类似数组的对象作为参数。该数组的所有成员，都会自动成为WeakSet实例的对象的成员。</p>
<p>注意，是数组参数的成员成为WeakSet的成员，而不是数组本身，数组参数成员只能是对象</p>
<p>WeakSet结构有以下三个方法。</p>
<p>WeakSet.prototype.add(values)：向 WeakSet 实例添加一个新成员。</p>
<p>WeakSet.prototype.delete(value)：清除 WeakSet 实例的指定成员。</p>
<p>WeakSet.prototype.has(value)：返回一个布尔值，表示某个值是否在 WeakSet 实例之中。</p>
<p>WeakSet 没有size属性，没有办法遍历它的成员。</p>
<h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><h4 id="含义和基本用法"><a href="#含义和基本用法" class="headerlink" title="含义和基本用法"></a>含义和基本用法</h4><p>ES6 提供了 Map 数据结构，它类似于对象，也是键值对的集合，但是键的范围不限于字符串，各种类型的值都可以当做键。</p>
<p>作为构造函数，Map 也可以接受一个数组作为参数。该数组的成员是一个个表示键值对的数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</div><div class="line">    [<span class="string">'name'</span>, <span class="string">'张三'</span>],</div><div class="line">    [<span class="string">'title'</span>, <span class="string">'Author'</span>]</div><div class="line">]);</div><div class="line"></div><div class="line">map.size <span class="comment">// 2</span></div><div class="line">map.has(<span class="string">'name'</span>) <span class="comment">// true</span></div><div class="line">map.get(<span class="string">'name'</span>) <span class="comment">// "张三"</span></div><div class="line">map.has(<span class="string">'title'</span>) <span class="comment">// true</span></div><div class="line">map.get(<span class="string">'title'</span>) <span class="comment">// "Author"</span></div></pre></td></tr></table></figure>
<p>Set 对象和 Map 对象当作Map构造函数的参数都生成了新的 Map 对象。</p>
<p>如果对同一个键多次赋值，后面的值将覆盖前面的值。</p>
<p>如果读取一个未知的键，则返回undefined。</p>
<p>注意，只有对同一个对象的引用，Map 结构才将其视为同一个键。这一点要非常小心。</p>
<h4 id="实例的属性和操作方法"><a href="#实例的属性和操作方法" class="headerlink" title="实例的属性和操作方法"></a>实例的属性和操作方法</h4><p>(1)size属性返回 Map 结构的成员总数。</p>
<p>(2)set(key, value)方法设置键名key对应的键值为value，然后返回整个 Map 结构。如果key已经有值，则键值会被更新，否则就新生成该键。</p>
<p>set方法返回的是当前的Map对象，因此可以采用链式写法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>()</div><div class="line">    .set(<span class="number">1</span>, <span class="string">'a'</span>)</div><div class="line">    .set(<span class="number">2</span>, <span class="string">'b'</span>)</div><div class="line">    .set(<span class="number">3</span>, <span class="string">'c'</span>);</div></pre></td></tr></table></figure>
<p>(3)get(key)方法读取key对应的键值，如果找不到key，返回undefined。</p>
<p>(4)has(key)方法返回一个布尔值，表示某个键是否在当前 Map 对象之中。</p>
<p>(5)delete(key)delete方法删除某个键，返回true。如果删除失败，返回false。</p>
<p>(6)clear()clear方法清除所有成员，没有返回值。</p>
<h4 id="遍历方法"><a href="#遍历方法" class="headerlink" title="遍历方法"></a>遍历方法</h4><p>Map 结构原生提供三个遍历器生成函数和一个遍历方法。</p>
<p>keys()：返回键名的遍历器。</p>
<p>values()：返回键值的遍历器。</p>
<p>entries()：返回所有成员的遍历器。</p>
<p>forEach()：遍历 Map 的所有成员。</p>
<p>Map forEach方法，与数组的forEach方法类似，也可以实现遍历。forEach方法还可以接受第二个参数，用来绑定this。</p>
<h4 id="与其他数据结构转换"><a href="#与其他数据结构转换" class="headerlink" title="与其他数据结构转换"></a>与其他数据结构转换</h4><p>(1)Map 转为数组</p>
<p>Map 转为数组最方便的方法，就是使用扩展运算符（…）。</p>
<p>(2)数组 转为 Map</p>
<p>将数组传入 Map 构造函数，就可以转为 Map。</p>
<p>(3)Map 转为对象</p>
<p>如果所有 Map 的键都是字符串，它可以转为对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">strMapToObj</span>(<span class="params">strMap</span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> obj = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> [k,v] <span class="keyword">of</span> strMap) &#123;</div><div class="line">        obj[k] = v;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> obj;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> myMap = <span class="keyword">new</span> <span class="built_in">Map</span>()</div><div class="line">    .set(<span class="string">'yes'</span>, <span class="literal">true</span>)</div><div class="line">    .set(<span class="string">'no'</span>, <span class="literal">false</span>);</div><div class="line">strMapToObj(myMap)</div></pre></td></tr></table></figure>
<p>(4)对象转为 Map</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">objToStrMap</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> strMap = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> k <span class="keyword">of</span> <span class="built_in">Object</span>.keys(obj)) &#123;</div><div class="line">        strMap.set(k, obj[k]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> strMap;</div><div class="line">&#125;</div><div class="line"></div><div class="line">objToStrMap(&#123;<span class="attr">yes</span>: <span class="literal">true</span>, <span class="attr">no</span>: <span class="literal">false</span>&#125;)</div></pre></td></tr></table></figure>
<p>(5)Map 转为 JSON</p>
<p>Map 转为 JSON 要区分两种情况。一种情况是，Map 的键名都是字符串，这时可以选择转为对象 JSON。</p>
<p>另一种情况是，Map 的键名有非字符串，这时可以选择转为数组 JSON。</p>
<h3 id="WeakMap"><a href="#WeakMap" class="headerlink" title="WeakMap"></a>WeakMap</h3><h4 id="含义"><a href="#含义" class="headerlink" title="含义"></a>含义</h4><p>WeakMap结构与Map结构类似，也是用于生成键值对的集合</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// WeakMap 可以使用 set 方法添加成员</span></div><div class="line"><span class="keyword">const</span> wm1 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</div><div class="line"><span class="keyword">const</span> key = &#123;<span class="attr">foo</span>: <span class="number">1</span>&#125;;</div><div class="line">wm1.set(key, <span class="number">2</span>);</div><div class="line">wm1.get(key) <span class="comment">// 2</span></div><div class="line"></div><div class="line"><span class="comment">// WeakMap 也可以接受一个数组，</span></div><div class="line"><span class="comment">// 作为构造函数的参数</span></div><div class="line"><span class="keyword">const</span> k1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line"><span class="keyword">const</span> k2 = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>];</div><div class="line"><span class="keyword">const</span> wm2 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>([[k1, <span class="string">'foo'</span>], [k2, <span class="string">'bar'</span>]]);</div><div class="line">wm2.get(k2) <span class="comment">// "bar"</span></div></pre></td></tr></table></figure>
<h5 id="WeakMap与Map的区别有两点。"><a href="#WeakMap与Map的区别有两点。" class="headerlink" title="WeakMap与Map的区别有两点。"></a>WeakMap与Map的区别有两点。</h5><p>首先WeakMap只接受对象作为键名除外，不接受其他类型的值作为键名。</p>
<p>其次WeakMap的键名所指向的对象，不计入垃圾回收机制</p>
<p>WeakMap的专用场合就是，它的键所对应的对象，可能会在将来消失。WeakMap结构有助于防止内存泄漏。</p>
<p>注意，WeakMap 弱引用的只是键名，而不是键值。键值依然是正常引用。</p>
<h4 id="WeakMap-的语法"><a href="#WeakMap-的语法" class="headerlink" title="WeakMap 的语法"></a>WeakMap 的语法</h4><p>WeakMap 与 Map 在 API 上的区别主要是两个，一是没有遍历操作（即没有key()、values()和entries()方法），也没有size属性。</p>

      
    </div>

    
      
      



      
      
    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/blogs/tags/ES6/">ES6</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
    
      <a class="next" href="/blogs/2018/01/18/es6-symbol/">
        <span class="next-text nav-default">NEXT</span>
        <span class="prev-text nav-mobile">NEXT</span>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    
  </div>


<div class="copyright">

  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2018

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Songzhiguo powered by Hexo</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    <div class="modal fade"></div>
    <section class="popup">
        <div id="site_search">
            <input type="text" id="local-search-input" placeholder="find something…" results="0"/>
            <div id="local-search-result"></div>
        </div>
        <span class="popup-btn-close" id="popupClose">close</span>
    </section>
    
  


    
  





  
    <script type="text/javascript" src="/blogs/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/blogs/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/blogs/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/blogs/js/src/even.js?v=2.6.0"></script>
<script type="text/javascript" src="/blogs/js/src/bootstrap.js?v=2.6.0"></script>
<script type="text/javascript" src="/blogs/js/src/search.js?v=2.6.0"></script>

  </body>
</html>
